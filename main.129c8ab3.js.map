{"version":3,"sources":["scripts/main.js"],"names":["htmlElements","cells","field","document","querySelector","trList","children","gameScore","messageList","start","size","score","handleStart","classList","remove","add","textContent","hideMessages","createFields","item","tr","trElements","td","push","createCells","i","Array","fill","generateInEmtyCell","x","y","Math","floor","random","draw","cellValue","innerHTML","String","removeAttribute","slide","array","sizeGame","filterEmty","arrayCells","filter","value","arr","length","slideLeft","changed","old","from","join","swap","x1","y1","x2","y2","tmp","mirror","xLeft","xRight","transpose","moveLeft","moveRight","moveUp","moveDown","checkIsWin","isGameOver","c","init","forEach","addEventListener","e","code","ok","messageLose","toggle","messageWin"],"mappings":"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","file":"main.129c8ab3.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\n\nconst field = document.querySelector('.game-field');\nconst trList = field.children[0].children;\nconst gameScore = document.querySelector('.game-score');\nconst messageList = document.querySelector('.message-container').children;\nconst start = document.querySelector('.start');\n\nconst size = 4;\nlet htmlElements;\nlet cells;\nlet score = 0;\n\nstart.addEventListener('click', () => {\n  init();\n  hideMessages();\n  handleStart();\n});\n\nfunction handleStart() {\n  start.classList.remove('start');\n  start.classList.add('restart');\n  start.textContent = 'Restart';\n  gameScore.textContent = score;\n}\n\nfunction hideMessages() {\n  for (const message of messageList) {\n    message.classList.add('hidden');\n  }\n}\n\nfunction createFields() {\n  if (htmlElements) {\n    return;\n  }\n\n  htmlElements = [];\n\n  for (const item of trList) {\n    const tr = item.cells;\n    const trElements = [];\n\n    for (const td of tr) {\n      trElements.push(td);\n    }\n\n    htmlElements.push(trElements);\n  }\n}\n\nfunction createCells() {\n  cells = [];\n\n  for (let i = 0; i < size; i++) {\n    cells.push(new Array(size).fill(0));\n  }\n}\n\nfunction generateInEmtyCell() {\n  let x, y;\n\n  do {\n    x = Math.floor(Math.random() * size);\n    y = Math.floor(Math.random() * size);\n\n    if (cells[y][x] === 0) {\n      cells[y][x] = Math.random() >= 0.9 ? 4 : 2;\n      break;\n    }\n  } while (true);\n}\n\nfunction draw() {\n  for (let y = 0; y < size; y++) {\n    for (let x = 0; x < size; x++) {\n      const td = htmlElements[y][x];\n      const cellValue = cells[y][x];\n\n      td.innerHTML = cellValue === 0 ? '' : String(cellValue);\n\n      if (cellValue === 0) {\n        td.removeAttribute('class');\n        td.classList.add('field-cell');\n      } else {\n        td.removeAttribute('class');\n        td.classList.add(`field-cell`);\n        td.classList.add(`field-cell--${cellValue}`);\n      }\n    }\n  }\n}\n\nfunction slide(array, sizeGame) {\n  function filterEmty(arrayCells) {\n    return arrayCells.filter(value => value !== 0);\n  }\n\n  let arr = array;\n\n  arr = filterEmty(arr);\n\n  if (arr.length > 0) {\n    for (let i = 0; i < arr.length - 1; i++) {\n      if (arr[i] === arr[i + 1]) {\n        arr[i] *= 2;\n        arr[i + 1] = 0;\n        score += arr[i];\n      }\n    }\n  }\n  arr = filterEmty(arr);\n\n  while (arr.length < sizeGame) {\n    arr.push(0);\n  }\n\n  return arr;\n}\n\nfunction slideLeft() {\n  let changed = false;\n\n  for (let i = 0; i < size; i++) {\n    const old = Array.from(cells[i]);\n\n    cells[i] = slide(cells[i], size);\n    changed = changed || (cells[i].join(',') !== old.join(','));\n  }\n\n  return changed;\n}\n\nfunction swap(x1, y1, x2, y2) {\n  const tmp = cells[y1][x1];\n\n  cells[y1][x1] = cells[y2][x2];\n  cells[y2][x2] = tmp;\n}\n\nfunction mirror() {\n  for (let y = 0; y < size; y++) {\n    for (let xLeft = 0, xRight = size - 1; xLeft < xRight; xLeft++, xRight--) {\n      swap(xLeft, y, xRight, y);\n    }\n  }\n}\n\nfunction transpose() {\n  for (let y = 0; y < size; y++) {\n    for (let x = 0; x < y; x++) {\n      swap(x, y, y, x);\n    }\n  }\n}\n\nfunction moveLeft() {\n  return slideLeft();\n}\n\nfunction moveRight() {\n  mirror();\n\n  const changed = moveLeft();\n\n  mirror();\n\n  return changed;\n}\n\nfunction moveUp() {\n  transpose();\n\n  const changed = moveLeft();\n\n  transpose();\n\n  return changed;\n}\n\nfunction moveDown() {\n  transpose();\n\n  const changed = moveRight();\n\n  transpose();\n\n  return changed;\n}\n\nfunction checkIsWin() {\n  for (let y = 0; y < size; y++) {\n    for (let x = 0; x < size; x++) {\n      if (cells[y][x] === 2048) {\n        return false;\n      }\n    }\n  }\n}\n\nfunction isGameOver() {\n  for (let y = 0; y < size; y++) {\n    for (let x = 0; x < size; x++) {\n      if (cells[y][x] === 0) {\n        return false;\n      }\n    }\n  }\n\n  for (let y = 0; y < size - 1; y++) {\n    for (let x = 0; x < size - 1; x++) {\n      const c = cells[y][x];\n\n      if (c !== 0 && (c === cells[y + 1][x] || c === cells[y][x + 1])) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\ndocument.addEventListener('keyup', (e) => {\n  const code = e.code;\n  let ok;\n\n  switch (code) {\n    case 'ArrowDown':\n      ok = moveDown();\n      break;\n    case 'ArrowUp':\n      ok = moveUp();\n      break;\n    case 'ArrowLeft':\n      ok = moveLeft();\n      break;\n    case 'ArrowRight':\n      ok = moveRight();\n      break;\n    default:\n      return;\n  }\n\n  if (ok) {\n    start.textContent = 'Restart';\n    generateInEmtyCell();\n    draw();\n  }\n\n  if (isGameOver()) {\n    const messageLose = document.querySelector('.message-lose');\n\n    hideMessages();\n    messageLose.classList.toggle('hidden');\n  }\n\n  if (checkIsWin()) {\n    const messageWin = document.querySelector('.message-win');\n\n    hideMessages();\n    messageWin.classList.toggle('hidden');\n  }\n\n  gameScore.textContent = score;\n});\n\nfunction init() {\n  createFields();\n  createCells();\n  new Array(2).fill(0).forEach(generateInEmtyCell);\n  draw();\n  score = 0;\n}\n"]}